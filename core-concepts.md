# 核心概念

## 沙盒实例

沙盒实例是系统中的核心资源，它是一个基于AWS EC2的虚拟机实例，提供独立的计算环境。

### 生命周期

沙盒实例有以下几种状态：

1. **PENDING**：沙盒正在创建中，包括EC2实例启动和初始化配置阶段
2. **RUNNING**：沙盒正常运行中，可以访问
3. **STOPPED**：沙盒已停止，实例不再运行但数据保留
4. **TERMINATED**：沙盒已终止/删除

生命周期转换图：

```
PENDING -> RUNNING -> STOPPED -> TERMINATED
    |         |         |
    v         v         v
  ERROR <-- ERROR <-- ERROR
```

详细的沙盒生命周期时序图请参见[生命周期时序图文档](../design/lifecycle-diagrams.md)。

### 持久化

沙盒实例使用以下存储方式：

- **实例存储**：临时存储，实例停止后数据丢失
- **EBS卷**：持久化存储，实例停止后数据保留
- **快照**：在创建镜像时生成，用于保存实例状态

### 资源管理

沙盒实例的资源管理主要包括：

- **计算资源**：CPU核心数和内存大小
- **存储资源**：磁盘空间和I/O性能
- **网络资源**：带宽和公网IP

## 实例模板

实例模板（即镜像）是创建沙盒实例的蓝图，包含操作系统和预安装的软件。

详细的镜像生命周期时序图请参见[生命周期时序图文档](../design/lifecycle-diagrams.md#镜像生命周期时序图)。

### 配置选项

镜像配置包括以下核心要素：

- **基础镜像**：操作系统和基础软件包
- **预装软件**：开发工具、服务组件等
- **配置文件**：系统和应用配置
- **初始化脚本**：首次启动时执行的脚本

### 自定义CPU和内存

沙盒实例支持自定义CPU和内存配置：

- **CPU**：可选择不同核心数量
- **内存**：可选择不同内存大小

通过`instanceSpecification`参数指定，格式为`{CPU核心数}u{内存GB数}g`，例如：
- `1u1g`：1核心1GB内存
- `2u4g`：2核心4GB内存

### 初始化脚本

初始化脚本在沙盒实例首次启动时执行，用于：

- 配置系统环境
- 启动应用服务
- 准备开发环境
- 加载数据

初始化脚本可以通过镜像预设，也可以在创建沙盒时通过配置参数提供。 